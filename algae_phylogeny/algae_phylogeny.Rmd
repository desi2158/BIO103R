---
title: "Using R in field sampling"
author: "Linda Forrester"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### The R Software

You will be using **R** for data analysis this semester. Here are some great reasons to use **R**:
[http://www.datacarpentry.org/R-ecology-lesson/00-before-we-start.html](http://www.datacarpentry.org/R-ecology-lesson/00-before-we-start.html)

See [instructions](Rsetup.html) for accessing R via the web or downloading to your computer.

Open RStudio and make a new project. Select File - New Project then New Directory and Empty Project and give it a name. You now have four windows open: a script to help you keep track of the commands you are entering, a console where those commands are run, an environment that show what data you have, and a file window.

## Get your data into R so you can use it

Last week you calculated the diversity index for each plot within each of four site types. This allows you to understand the variation in diversity among site types.

* Load class data for the diversity of each plot by getting it into R directly from google sheets.
  * if you are using your personal computer you must install the necessary package first by typing install.packages('gsheet')
  * assign the web address of the data to a variable
  * assign the data itself to a variable (in this case we named it `diversitydata`)
  * `gsheet2tbl` is a command that gets the data from the website so that you can access it in RStudio

```{r gsheet}
library(gsheet)
url<-'https://docs.google.com/spreadsheets/d/1_FtL2E935fvANST8JMP50QVQzIVoaZgXyNpLZnVRW-k'
diversitydata <- gsheet2tbl(url)
```

* run these lines using the run button above
* you will need to run each line separately
* the line was run correctly if you get the prompt (`>`) in the console window at the bottom of RStudio
* view your data by clicking on the item in the Data window on the right side (mine is called `diversitydata` - yours may be named something else) - this will open a new tab above so you can look at the data

## Keep track of what your commands do

As you work you are typing commands that you probably won't remember next week. Add comments about your commands using the `#` symbol. For example, rather than the plain code above your script might look like the following:

```{r gsheet2, eval=FALSE}
#load the package that allows use to access google sheets
library(gsheet)

#assign the website address for the data to a variable
url<-'https://docs.google.com/spreadsheets/d/1_FtL2E935fvANST8JMP50QVQzIVoaZgXyNpLZnVRW-k'

#load the data from google sheets
diversitydata <- gsheet2tbl(url)
```

**Add comments to your script as you enter the commands below**

## Plot results

To compare the diversity values among site types we need to plot the values for each site type.

* load the library that allows us to the plotting commands

```{r loadlibrary}
library(ggplot2)
```

### Create the base layer of your plot 

* using the command `ggplot`
* enter the name of the variable containing your data
* `aes` specifies the "aesthetics" of the plot (i.e. how it looks), including the x and y variables
* specify the variable names based on viewing the data
* run this plot command

```{r }
ggplot(diversitydata, aes(x=SiteType,y=Diversity))
```

### Add points to your plot

* now that you have set up your plot add your points using `geom_point()`
* put a `+` between the `ggplot` command and `geom_point()`

```{r }
ggplot(diversitydata, aes(x=SiteType,y=Diversity))+
  geom_point()
```

### Add a boxplot to your plot

* a boxplot summarizes your data by plotting 
  * the median (middle) value as a horizontal line
  * the middle half of the data as a box
  * the remaining top and bottom quarters of the data as lines above and below the box
  
* add a boxplot using `geom_boxplot()`
* put a `+` between the `geom_point()` command and `geom_boxplot()`

```{r }
ggplot(diversitydata, aes(x=SiteType,y=Diversity))+
  geom_point()+
  geom_boxplot()
```

* in order to see both the box and the points plot the box first then the point layer on top
  * note: the order of the plotting instructions specify how the plot is made - i.e. first the base, then the points, then the box covering the points
* plot just the boxplot as this is the typical way to visualize the data

### Reorder data

If you want to make particular comparisons, such as between mowed sites, you might want to have your data in a particular order.

* plot the two mowed sites on the left and the two unmowed sides on the right side of the plot
* `scale_x_discrete` allows you to change all the information on the x axis
  * limits specifies the range of data on the x axis - since the data are categorical not continuous (e.g. from 1-10) you put the items in a list

```{r }
ggplot(diversitydata, aes(x=SiteType,y=Diversity))+
  geom_boxplot()+
  scale_x_discrete(limits=c("SuM", "ShM", "SuNM", "ShNM"))
```

### Add labels to your plot

* you can use `scale_x_discrete` to relabel the category names to something more descriptive and to specify the overall x axis name

```{r }
ggplot(diversitydata, aes(x=SiteType,y=Diversity))+
  geom_boxplot()+
  scale_x_discrete(limits=c("SuM", "ShM", "SuNM", "ShNM"), 
                   labels=c("SuM" = "Sun Mow", "ShM" = "Shade Mow",
                              "SuNM" = "Sun Not Mow", "ShNM" = "Shade No Mow"),
                   name ="Type of Site")

```

**Turn in this final boxplot of the data**

## Homework Assignment

* Make a boxplot comparing diversity among terrestrial biomes of the world.
* Data are available at https://docs.google.com/spreadsheets/d/1KAur7rjQtw3zN1bEQR_xXr0JRS3yn1nnvdrzQu6gWaw 
* Create a new R script
* load the necessary libraries
* load your data
* make a boxplot based on the final plot you made in class
* in the limits and labels only include the three biomes you were assigned

**Write a one sentence (or more) statement describing differences in diversity among the biomes you were assigned**